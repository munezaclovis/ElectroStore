@using Microsoft.AspNetCore.Identity
@using Microsoft.EntityFrameworkCore;
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager
@inject ApplicationDbContext _context;


@{
	var cartSize = _context.Carts.Include(x => x.CartItems).FirstOrDefault().CartItems.Count;
}

<ul class="list-unstyled topbar-nav float-right mb-0">
	@if (SignInManager.IsSignedIn(User))
	{
		<li class="dropdown notification-list">
			<a class="nav-link dropdown-toggle arrow-none waves-light waves-effect" asp-area="" asp-controller="Cart" asp-action="Index">
				<i class="dripicons-cart noti-icon"></i>
				<span class="badge badge-danger badge-pill noti-icon-badge">@cartSize</span>
			</a>
		</li>

		<li class="dropdown">
			<a class="nav-link dropdown-toggle waves-effect waves-light nav-user pr-0" data-toggle="dropdown" href="#" role="button"
			   aria-haspopup="false" aria-expanded="false">
				<img src="~/images/users/user-4.jpg" alt="profile-user" class="rounded-circle" />
				<span class="ml-1 nav-user-name hidden-sm">@User.Identity.Name! <i class="mdi mdi-chevron-down"></i> </span>
			</a>
			<div class="dropdown-menu dropdown-menu-right">
				<a class="dropdown-item" asp-area="Identity" asp-page="/Account/Manage/Index"><i class="dripicons-user text-muted mr-2"></i> Profile</a>
				<a class="dropdown-item" asp-area="Managent" asp-controller="Settings" asp-action="Index"><i class="dripicons-gear text-muted mr-2"></i> Settings</a>
				<div class="dropdown-divider"></div>
				<form id="logoutForm" style="padding:0!important" class="dropdown-item" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
					<button type="submit" class="btn-text"><i class="dripicons-exit text-muted mr-2"></i> Logout</button>
				</form>
			</div>
		</li><!--end dropdown-->
		<li class="menu-item">
			<!-- Mobile menu toggle-->
			<a class="navbar-toggle nav-link" id="mobileToggle">
				<div class="lines">
					<span></span>
					<span></span>
					<span></span>
				</div>
			</a>
			<!-- End mobile menu toggle-->
		</li>
		<!--end menu item-->
	}
	else
	{
		<li class="menu-item">
			<a style="font-size:14px" class="nav-link" asp-area="Identity" asp-page="/Account/Login"><i class="dripicons-enter mr-2"></i><span>Login</span></a>
		</li>
		<li class="menu-item">
			<a style="font-size:14px" class="nav-link" asp-area="Identity" asp-page="/Account/Register"><i class="dripicons-pencil mr-2"></i><span>Register</span></a>
		</li>
	}
</ul>